<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ExcelÊï∞ÊçÆÁîüÊàêÂô®</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        #previewTable th, #previewTable td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        #previewTable th {
            background-color: #f5f5f5;
        }

        #previewTable tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        #previewTable tr:hover {
            background-color: #f5f5f5;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Roboto', Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
            background-color: #f5f7fa;
            color: #2c3e50;
        }

        h1 {
            text-align: center;
            color: #34495e;
            margin-bottom: 40px;
            font-weight: 500;
            font-size: 2.5em;
        }

        .upload-section {
            background: white;
            margin: 50px auto;
            padding: 50px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s ease;
            border: 3px dashed #3498db;
            width: 80%;
            max-width: 800px;
        }

        .upload-section.drag-over {
            background-color: #f8f9fa;
            border-color: #2ecc71;
        }

        .upload-section .upload-icon {
            font-size: 48px;
            color: #3498db;
            margin-bottom: 20px;
        }

        .upload-section:hover {
            transform: translateY(-5px);
        }

        .upload-section input[type="file"] {
            display: none;
        }

        .upload-button {
            display: inline-block;
            padding: 12px 24px;
            background-color: #3498db;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-size: 1.1em;
        }

        .upload-button:hover {
            background-color: #2980b9;
        }

        .fields-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .field-config {
            background: #f8f9fa;
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .field-config:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .field-config h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .field-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            align-items: center;
        }

        .field-row label {
            min-width: 100px;
            color: #7f8c8d;
        }

        select, input[type="text"], input[type="number"] {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #3498db;
        }

        .generate-section {
            margin-top: 30px;
            text-align: center;
        }

        .row-count-input {
            margin-bottom: 20px;
            text-align: center;
        }

        .row-count-input label {
            display: block;
            margin-bottom: 10px;
            color: #7f8c8d;
        }

        .row-count-input input {
            width: 200px;
            text-align: center;
        }

        button {
            padding: 12px 30px;
            background-color: #2ecc71;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }

        button:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
        }

        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .loading.active {
            display: flex;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .field-row input[type="checkbox"] {
            width: auto;
            padding: 0;
            margin-right: 5px;
        }
        
        .field-row .checkbox-info {
            color: #7f8c8d;
            font-size: 12px;
            margin-left: 5px;
        }

        .distribution-field {
            background-color: #f0f7ff;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            border-left: 3px solid #3498db;
        }

        .multi-separator-field {
            background-color: #f0fff7;
            padding: 10px;
            border-radius: 5px;
            border-left: 3px solid #2ecc71;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            width: 100%;
        }

        .option-buttons {
            margin-bottom: 10px;
        }

        .add-option-btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .add-option-btn:hover {
            background-color: #2980b9;
        }

        .options-inputs {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .option-input-row {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .option-input {
            flex: 1;
            padding: 8px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
        }

        .remove-option-btn {
            background-color: #e74c3c;
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            padding: 0;
            line-height: 1;
        }

        .remove-option-btn:hover {
            background-color: #c0392b;
        }
    </style>
</head>
<body>
    <h1>ExcelÊï∞ÊçÆÁîüÊàêÂô®</h1>
    
    <div class="upload-section" id="dropZone">
        <div class="upload-icon">üìÅ</div>
        <label class="upload-button" for="excelFile">
            <span>ÈÄâÊã©ExcelÊñá‰ª∂</span>
            <input type="file" id="excelFile" accept=".xlsx,.xls" />
        </label>
        <p style="margin-top: 15px; color: #7f8c8d;">ÊîØÊåÅ.xlsxÂíå.xlsÊ†ºÂºèÊñá‰ª∂<br>ÁÇπÂáªÈÄâÊã©ÊàñÊãñÊîæÊñá‰ª∂Âà∞Ê≠§Â§Ñ</p>
    </div>

    <div id="fieldsContainer" class="fields-section" style="display: none;">
        <h2 style="margin-bottom: 30px; color: #34495e;">Â≠óÊÆµÈÖçÁΩÆ</h2>
        <div id="fieldsList"></div>
        
        <div class="generate-section">
            <div class="row-count-input">
                <label>ÁîüÊàêÊï∞ÊçÆË°åÊï∞Ôºö</label>
                <input type="number" id="rowCount" value="100" min="1" max="10000" />
            </div>
            <button onclick="previewData()">È¢ÑËßàÊï∞ÊçÆ</button>
            <button onclick="generateData()">ÁîüÊàêExcel</button>
        </div>
        <div id="previewContainer" style="display: none; margin-top: 20px;">
            <h3>Êï∞ÊçÆÈ¢ÑËßà</h3>
            <div style="overflow-x: auto;">
                <table id="previewTable" style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                    <thead></thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="loading">
        <div class="loading-spinner"></div>
    </div>

    <script>
        let workbook = null;
        let fields = [];

        document.getElementById('excelFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const loading = document.querySelector('.loading');
            loading.classList.add('active');

            const reader = new FileReader();

            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                workbook = XLSX.read(data, {type: 'array'});
                
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(firstSheet, {header: 1});
                
                fields = jsonData[0];
                displayFields(fields);
                loading.classList.remove('active');
            };

            reader.onerror = function() {
                alert('Êñá‰ª∂ËØªÂèñÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');
                loading.classList.remove('active');
            };

            reader.readAsArrayBuffer(file);
        });

        function displayFields(fields) {
            const container = document.getElementById('fieldsList');
            container.innerHTML = '';
            
            fields.forEach(field => {
                const fieldDiv = document.createElement('div');
                fieldDiv.className = 'field-config';
                
                // ÂÖàÂàõÂª∫ÂÆåÊï¥ÁöÑHTMLÁªìÊûÑ
                fieldDiv.innerHTML = `
                    <h3>${field}</h3>
                    <div class="field-row">
                        <label>Êï∞ÊçÆÁ±ªÂûãÔºö</label>
                        <select id="type_${field}" onchange="updateFieldVisibility('${field}')">
                            <option value="text">ÊñáÊú¨</option>
                            <option value="number">Êï∞Â≠ó</option>
                            <option value="date">Êó•Êúü</option>
                            <option value="boolean">Â∏ÉÂ∞îÂÄº</option>
                            <option value="email">ÁîµÂ≠êÈÇÆ‰ª∂</option>
                            <option value="phone">ÊâãÊú∫Âè∑Á†Å</option>
                            <option value="address">Âú∞ÂùÄ</option>
                        </select>
                    </div>
                    <div class="field-row distribution-field" id="distribution_row_${field}">
                        <label>ÂàÜÂ∏ÉÁ±ªÂûãÔºö</label>
                        <select id="distribution_${field}">
                            <option value="uniform">ÂùáÂåÄÂàÜÂ∏É</option>
                            <option value="normal">Ê≠£ÊÄÅÂàÜÂ∏É</option>
                            <option value="exponential">ÊåáÊï∞ÂàÜÂ∏É</option>
                            <option value="poisson">Ê≥äÊùæÂàÜÂ∏É</option>
                            <option value="binomial">‰∫åÈ°πÂàÜÂ∏É</option>
                            <option value="geometric">Âá†‰ΩïÂàÜÂ∏É</option>
                            <option value="lognormal">ÂØπÊï∞Ê≠£ÊÄÅÂàÜÂ∏É</option>
                            <option value="pareto">Â∏ïÁ¥ØÊâòÂàÜÂ∏É</option>
                            <option value="gamma">‰ºΩÈ©¨ÂàÜÂ∏É</option>
                            <option value="beta">Ë¥ùÂ°îÂàÜÂ∏É</option>
                        </select>
                    </div>
                    <div class="field-row">
                        <label>ÊòØÂê¶Â§öÈÄâÔºö</label>
                        <input type="checkbox" id="multi_${field}" style="width: auto; margin-right: 5px;">
                        <span class="checkbox-info">(Â§öÈÄâÊó∂Â∞ÜÈöèÊú∫ÁîüÊàê1-n‰∏™‰∏çÈáçÂ§çÂÄº)</span>
                    </div>
                    <div class="field-row multi-separator-field" id="multi_separator_row_${field}" style="display: none;">
                        <label>Â§öÈÄâÂàÜÈöîÁ¨¶Ôºö</label>
                        <input type="text" id="multi_separator_${field}" placeholder="Â§öÈÄâÂÄº‰πãÈó¥ÁöÑÂàÜÈöîÁ¨¶" value="|" />
                    </div>
                    <div class="field-row number-field" id="min_row_${field}">
                        <label>ÊúÄÂ∞èÂÄºÔºö</label>
                        <input type="text" id="min_${field}" placeholder="ËØ∑ËæìÂÖ•ÊúÄÂ∞èÂÄº" />
                    </div>
                    <div class="field-row number-field" id="max_row_${field}">
                        <label>ÊúÄÂ§ßÂÄºÔºö</label>
                        <input type="text" id="max_${field}" placeholder="ËØ∑ËæìÂÖ•ÊúÄÂ§ßÂÄº" />
                    </div>
                    <div class="field-row number-field" id="decimal_row_${field}">
                        <label>Â∞èÊï∞ÁÇπËÆæÁΩÆÔºö</label>
                        <select id="decimal_${field}">
                            <option value="auto">Ëá™Âä®(Ê†πÊçÆÂàÜÂ∏ÉÁ±ªÂûã)</option>
                            <option value="0">Êó†Â∞èÊï∞ÁÇπ</option>
                            <option value="1">‰øùÁïô1‰ΩçÂ∞èÊï∞</option>
                            <option value="2">‰øùÁïô2‰ΩçÂ∞èÊï∞</option>
                            <option value="3">‰øùÁïô3‰ΩçÂ∞èÊï∞</option>
                            <option value="4">‰øùÁïô4‰ΩçÂ∞èÊï∞</option>
                        </select>
                    </div>
                    <div class="field-row text-field" id="text_range_row_${field}" style="display: none;">
                        <label>ÂèØÈÄâÂÄºÔºö</label>
                        <div class="options-container" id="text_options_${field}">
                            <div class="option-buttons">
                                <button type="button" class="add-option-btn" onclick="addOptionInput('${field}', 'text')">Ê∑ªÂä†ÈÄâÈ°π</button>
                            </div>
                            <div class="options-inputs" id="text_inputs_${field}">
                                <div class="option-input-row">
                                    <input type="text" class="option-input" placeholder="ËØ∑ËæìÂÖ•ÈÄâÈ°πÂÄº"/>
                                    <button type="button" class="remove-option-btn" onclick="removeOptionInput(this)">√ó</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="field-row email-field" id="email_suffix_row_${field}" style="display: none;">
                        <label>ÈÇÆÁÆ±ÂêéÁºÄÔºö</label>
                        <div class="options-container" id="email_options_${field}">
                            <div class="option-buttons">
                                <button type="button" class="add-option-btn" onclick="addOptionInput('${field}', 'email')">Ê∑ªÂä†ÂêéÁºÄ</button>
                            </div>
                            <div class="options-inputs" id="email_inputs_${field}">
                                <div class="option-input-row">
                                    <input type="text" class="option-input" placeholder="ËØ∑ËæìÂÖ•ÈÇÆÁÆ±ÂêéÁºÄÔºåÂ¶ÇÔºögmail.com"/>
                                    <button type="button" class="remove-option-btn" onclick="removeOptionInput(this)">√ó</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="field-row address-field" id="provinces_row_${field}" style="display: none;">
                        <label>ÁúÅ‰ªΩÔºö</label>
                        <div class="options-container" id="provinces_options_${field}">
                            <div class="option-buttons">
                                <button type="button" class="add-option-btn" onclick="addOptionInput('${field}', 'province')">Ê∑ªÂä†ÁúÅ‰ªΩ</button>
                            </div>
                            <div class="options-inputs" id="province_inputs_${field}">
                                <div class="option-input-row">
                                    <input type="text" class="option-input" placeholder="ËØ∑ËæìÂÖ•ÁúÅ‰ªΩ"/>
                                    <button type="button" class="remove-option-btn" onclick="removeOptionInput(this)">√ó</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="field-row address-field" id="cities_row_${field}" style="display: none;">
                        <label>ÂüéÂ∏ÇÔºö</label>
                        <div class="options-container" id="cities_options_${field}">
                            <div class="option-buttons">
                                <button type="button" class="add-option-btn" onclick="addOptionInput('${field}', 'city')">Ê∑ªÂä†ÂüéÂ∏Ç</button>
                            </div>
                            <div class="options-inputs" id="city_inputs_${field}">
                                <div class="option-input-row">
                                    <input type="text" class="option-input" placeholder="ËØ∑ËæìÂÖ•ÂüéÂ∏Ç"/>
                                    <button type="button" class="remove-option-btn" onclick="removeOptionInput(this)">√ó</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="field-row address-field" id="districts_row_${field}" style="display: none;">
                        <label>Âå∫ÂüüÔºö</label>
                        <div class="options-container" id="districts_options_${field}">
                            <div class="option-buttons">
                                <button type="button" class="add-option-btn" onclick="addOptionInput('${field}', 'district')">Ê∑ªÂä†Âå∫Âüü</button>
                            </div>
                            <div class="options-inputs" id="district_inputs_${field}">
                                <div class="option-input-row">
                                    <input type="text" class="option-input" placeholder="ËØ∑ËæìÂÖ•Âå∫Âüü"/>
                                    <button type="button" class="remove-option-btn" onclick="removeOptionInput(this)">√ó</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(fieldDiv);

                // Âú®ÂÖÉÁ¥†Ê∑ªÂä†Âà∞DOMÂêéËÆæÁΩÆÂàùÂßãÂèØËßÅÊÄß
                const selectElement = document.getElementById(`type_${field}`);
                // ËÆæÁΩÆÈªòËÆ§Á±ªÂûã‰∏∫ÊñáÊú¨
                selectElement.value = "text";
                updateFieldVisibility(field);
                
                // ‰∏∫Â§öÈÄâÂ§çÈÄâÊ°ÜÊ∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®
                const multiCheckbox = document.getElementById(`multi_${field}`);
                multiCheckbox.addEventListener('change', () => {
                    updateFieldVisibility(field);
                });
            });

            document.getElementById('fieldsContainer').style.display = 'block';
        }

        // Ê∑ªÂä†Êñ∞ÁöÑÂáΩÊï∞Êù•Â§ÑÁêÜÂ≠óÊÆµÂèØËßÅÊÄß
        function updateFieldVisibility(field) {
            const type = document.getElementById(`type_${field}`).value;
            const numberFields = document.querySelectorAll(`#min_row_${field}, #max_row_${field}, #decimal_row_${field}`);
            const textField = document.getElementById(`text_range_row_${field}`);
            const emailField = document.getElementById(`email_suffix_row_${field}`);
            const addressFields = document.querySelectorAll(`#provinces_row_${field}, #cities_row_${field}, #districts_row_${field}`);
            const distributionField = document.getElementById(`distribution_row_${field}`);
            const multiSeparatorField = document.getElementById(`multi_separator_row_${field}`);

            // ÈöêËóèÊâÄÊúâÂ≠óÊÆµ
            numberFields.forEach(el => el.style.display = 'none');
            textField.style.display = 'none';
            emailField.style.display = 'none';
            addressFields.forEach(el => el.style.display = 'none');

            // Ê£ÄÊü•ÊòØÂê¶ÂºÄÂêØÂ§öÈÄâ
            const isMulti = document.getElementById(`multi_${field}`).checked;
            multiSeparatorField.style.display = isMulti ? 'flex' : 'none';

            // ÊâÄÊúâÁ±ªÂûãÈÉΩÊòæÁ§∫ÂàÜÂ∏ÉÁ±ªÂûã
            distributionField.style.display = 'flex';

            // Ê†πÊçÆÁ±ªÂûãÊòæÁ§∫Áõ∏Â∫îÂ≠óÊÆµ
            switch(type) {
                case 'number':
                case 'date':
                    numberFields.forEach(el => el.style.display = 'flex');
                    break;
                case 'text':
                    textField.style.display = 'flex';
                    break;
                case 'email':
                    emailField.style.display = 'flex';
                    break;
                case 'address':
                    addressFields.forEach(el => el.style.display = 'flex');
                    break;
            }
        }

        function generateRandomValue(type, min, max, field, isMulti, decimal) {
            const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
            const distribution = document.getElementById(`distribution_${field}`).value;
            const multiSeparator = document.getElementById(`multi_separator_${field}`).value || '|';
            
            // Ê†πÊçÆÂàÜÂ∏ÉËé∑ÂèñÈÄâÈ°πÁ¥¢Âºï
            const getDistributedIndex = (array) => {
                if (!array || array.length === 0) return 0;
                // ‰ΩøÁî®ÂàÜÂ∏ÉÁ±ªÂûãÂΩ±ÂìçÈÄâÊã©Ê¶ÇÁéá
                if (distribution === 'uniform') {
                    // ÂùáÂåÄÂàÜÂ∏É - ÊØè‰∏™ÈÄâÈ°πÊ¶ÇÁéáÁõ∏Âêå
                    return Math.floor(Math.random() * array.length);
                } else {
                    // ÂÖ∂‰ªñÂàÜÂ∏É - ‰ΩøÁî®ÂàÜÂ∏ÉÂáΩÊï∞ÁîüÊàêÁöÑÂÄºÊù•ÈÄâÊã©Á¥¢Âºï
                    const index = Math.floor(generateDistributedNumber(
                        distribution, 
                        0, 
                        array.length - 1,
                        1, 0, 1, 10, 0.5, 2, 2,
                        '0' // Âº∫Âà∂‰ΩøÁî®Êï¥Êï∞Á¥¢Âºï
                    ));
                    return Math.max(0, Math.min(array.length - 1, index));
                }
            };
            
            // Ëé∑ÂèñÂèØÈÄâÂÄºÊï∞ÁªÑÔºàÊ†πÊçÆÁ±ªÂûãÔºâ
            const getOptionsArray = () => {
                switch(type) {
                    case 'number':
                        min = parseFloat(min) || 0;
                        max = parseFloat(max) || 100;
                        // ÂØπ‰∫éÊï∞Â≠óÔºåÂàõÂª∫‰∏Ä‰∏™ÂèØËÉΩÁöÑÂÄºËåÉÂõ¥
                        const range = [];
                        // Ê†πÊçÆÂàÜÂ∏ÉÁ±ªÂûãÁîüÊàê‰∏çÂêåÁöÑÊï∞ÂÄº
                        for(let i = 0; i < 30; i++) { // ÁîüÊàêË∂≥Â§üÂ§öÁöÑ‰∏çÂêåÂÄº‰Ωú‰∏∫ÂèØÈÄâÈ°π
                            range.push(generateDistributedNumber(distribution, min, max, 1, 0, 1, 10, 0.5, 2, 2, decimal));
                        }
                        // ÂéªÈáç
                        return [...new Set(range)];
                    case 'text':
                        const textOptions = getOptionValues(field, 'text');
                        return textOptions.length > 0 ? 
                            textOptions : ['Á§∫‰æãÊñáÊú¨1', 'Á§∫‰æãÊñáÊú¨2', 'Á§∫‰æãÊñáÊú¨3'];
                    case 'date':
                        // ÂØπ‰∫éÊó•ÊúüÔºåÊ†πÊçÆÂàÜÂ∏ÉÁîüÊàêÊó•ÊúüÂÄº
                        const startDate = min ? new Date(min) : new Date('2020-01-01');
                        const endDate = max ? new Date(max) : new Date();
                        const startTime = startDate.getTime();
                        const endTime = endDate.getTime();
                        
                        const dateRange = [];
                        for(let i = 0; i < 30; i++) {
                            // ‰ΩøÁî®ÂàÜÂ∏ÉÁîüÊàêÊØî‰æãÂÄº(0-1)ÔºåÁÑ∂ÂêéËΩ¨Êç¢‰∏∫Êó∂Èó¥Êà≥
                            const ratio = generateDistributedNumber(distribution, 0, 100, 1, 0, 1, 10, 0.5, 2, 2, '2') / 100;
                            const timestamp = startTime + ratio * (endTime - startTime);
                            dateRange.push(new Date(timestamp).toISOString().split('T')[0]);
                        }
                        // ÂéªÈáç
                        return [...new Set(dateRange)];
                    case 'boolean':
                        return [true, false];
                    case 'email':
                        // ÁîüÊàê‰∏Ä‰∫õ‰∏çÂêåÁöÑÈÇÆÁÆ±‰Ωú‰∏∫ÂèØÈÄâÂÄº
                        const emailOptions = [];
                        const emailDomains = getOptionValues(field, 'email');
                        const availableDomains = emailDomains.length > 0 ? 
                            emailDomains : ['gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com', '163.com'];
                        
                        for(let i = 0; i < 10; i++) {
                            const username = Array.from({length: 8}, () => chars.charAt(Math.floor(Math.random() * chars.length))).join('');
                            emailOptions.push(`${username}@${availableDomains[getDistributedIndex(availableDomains)]}`);
                        }
                        return emailOptions;
                    case 'phone':
                        const prefixes = ['130', '131', '132', '133', '134', '135', '136', '137', '138', '139', '150', '151', '152'];
                        // ÁîüÊàê‰∏Ä‰∫õ‰∏çÂêåÁöÑÊâãÊú∫Âè∑‰Ωú‰∏∫ÂèØÈÄâÂÄº
                        const phones = [];
                        for(let i = 0; i < 10; i++) {
                            const prefix = prefixes[getDistributedIndex(prefixes)];
                            const suffix = Math.floor(Math.random() * 100000000).toString().padStart(8, '0');
                            phones.push(prefix + suffix);
                        }
                        return phones;
                    case 'address':
                        // ÁîüÊàê‰∏Ä‰∫õ‰∏çÂêåÁöÑÂú∞ÂùÄ‰Ωú‰∏∫ÂèØÈÄâÂÄº
                        const addresses = [];
                        const provinceOpts = getOptionValues(field, 'province');
                        const cityOpts = getOptionValues(field, 'city');
                        const districtOpts = getOptionValues(field, 'district');
                        
                        const availableProvinces = provinceOpts.length > 0 ? 
                            provinceOpts : ['Âåó‰∫¨Â∏Ç', '‰∏äÊµ∑Â∏Ç', 'Âπø‰∏úÁúÅ', 'Ê±üËãèÁúÅ', 'ÊµôÊ±üÁúÅ'];
                        const availableCities = cityOpts.length > 0 ? 
                            cityOpts : ['Â∏ÇËæñÂå∫', 'Âçó‰∫¨Â∏Ç', 'Êù≠Â∑ûÂ∏Ç', 'ÂπøÂ∑ûÂ∏Ç', 'Ê∑±Âú≥Â∏Ç'];
                        const availableDistricts = districtOpts.length > 0 ? 
                            districtOpts : ['ÊúùÈò≥Âå∫', 'Êµ∑Ê∑ÄÂå∫', 'Êµ¶‰∏úÊñ∞Âå∫', 'Á¶èÁî∞Âå∫', 'ÂßëËãèÂå∫'];
                        
                        for(let i = 0; i < Math.min(availableProvinces.length * availableCities.length, 10); i++) {
                            addresses.push(
                                `${availableProvinces[getDistributedIndex(availableProvinces)]}` +
                                `${availableCities[getDistributedIndex(availableCities)]}` +
                                `${availableDistricts[getDistributedIndex(availableDistricts)]}`
                            );
                        }
                        return addresses;
                    default:
                        return [''];
                }
            };
            
            // Âçï‰∏™ÂÄºÁîüÊàêÂáΩÊï∞
            const generateSingleValue = () => {
                switch(type) {
                    case 'number':
                        min = parseFloat(min) || 0;
                        max = parseFloat(max) || 100;
                        // ‰ΩøÁî®ÂàÜÂ∏ÉÂáΩÊï∞ÁîüÊàêÊï∞ÂÄº
                        return generateDistributedNumber(distribution, min, max, 1, 0, 1, 10, 0.5, 2, 2, decimal);
                    case 'text':
                        const textValues = getOptionValues(field, 'text');
                        const availableTexts = textValues.length > 0 ? 
                            textValues : ['Á§∫‰æãÊñáÊú¨1', 'Á§∫‰æãÊñáÊú¨2', 'Á§∫‰æãÊñáÊú¨3'];
                        return availableTexts[getDistributedIndex(availableTexts)];
                    case 'date':
                        const startDate = min ? new Date(min) : new Date('2020-01-01');
                        const endDate = max ? new Date(max) : new Date();
                        const startTime = startDate.getTime();
                        const endTime = endDate.getTime();
                        
                        // ‰ΩøÁî®ÂàÜÂ∏ÉÁîüÊàêÊØî‰æãÂÄº(0-1)ÔºåÁÑ∂ÂêéËΩ¨Êç¢‰∏∫Êó∂Èó¥Êà≥
                        const ratio = generateDistributedNumber(distribution, 0, 100, 1, 0, 1, 10, 0.5, 2, 2, '2') / 100;
                        const timestamp = startTime + ratio * (endTime - startTime);
                        return new Date(timestamp).toISOString().split('T')[0];
                    case 'boolean':
                        // ÂØπ‰∫éÂ∏ÉÂ∞îÂÄºÔºåÂèØ‰ª•Ê†πÊçÆÂàÜÂ∏ÉÂΩ±Âìçtrue/falseÁöÑÊ¶ÇÁéá
                        if (distribution === 'uniform') {
                            return Math.random() < 0.5; // ÂùáÂåÄÂàÜÂ∏ÉÔºå50%ÁöÑÊ¶ÇÁéá
                        } else {
                            // ÂÖ∂‰ªñÂàÜÂ∏É‰ΩøÁî®ÁîüÊàêÁöÑÂÄºÊù•Á°ÆÂÆöÊ¶ÇÁéá
                            const value = generateDistributedNumber(distribution, 0, 100, 1, 0, 1, 10, 0.5, 2, 2, '2') / 100;
                            return value < 0.5;
                        }
                    case 'email':
                        const emailDomainsForSingle = getOptionValues(field, 'email');
                        const availableDomainsForSingle = emailDomainsForSingle.length > 0 ? 
                            emailDomainsForSingle : ['gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com', '163.com'];
                        const usernameForSingle = Array.from({length: 8}, () => chars.charAt(Math.floor(Math.random() * chars.length))).join('');
                        return `${usernameForSingle}@${availableDomainsForSingle[getDistributedIndex(availableDomainsForSingle)]}`;
                    case 'phone':
                        const prefixes = ['130', '131', '132', '133', '134', '135', '136', '137', '138', '139', '150', '151', '152'];
                        const prefix = prefixes[getDistributedIndex(prefixes)];
                        const suffix = Math.floor(Math.random() * 100000000).toString().padStart(8, '0');
                        return prefix + suffix;
                    case 'address':
                        const provinceOptsForSingle = getOptionValues(field, 'province');
                        const cityOptsForSingle = getOptionValues(field, 'city');
                        const districtOptsForSingle = getOptionValues(field, 'district');
                        
                        const availableProvincesForSingle = provinceOptsForSingle.length > 0 ? 
                            provinceOptsForSingle : ['Âåó‰∫¨Â∏Ç', '‰∏äÊµ∑Â∏Ç', 'Âπø‰∏úÁúÅ', 'Ê±üËãèÁúÅ', 'ÊµôÊ±üÁúÅ'];
                        const availableCitiesForSingle = cityOptsForSingle.length > 0 ? 
                            cityOptsForSingle : ['Â∏ÇËæñÂå∫', 'Âçó‰∫¨Â∏Ç', 'Êù≠Â∑ûÂ∏Ç', 'ÂπøÂ∑ûÂ∏Ç', 'Ê∑±Âú≥Â∏Ç'];
                        const availableDistrictsForSingle = districtOptsForSingle.length > 0 ? 
                            districtOptsForSingle : ['ÊúùÈò≥Âå∫', 'Êµ∑Ê∑ÄÂå∫', 'Êµ¶‰∏úÊñ∞Âå∫', 'Á¶èÁî∞Âå∫', 'ÂßëËãèÂå∫'];
                        
                        return (
                            `${availableProvincesForSingle[getDistributedIndex(availableProvincesForSingle)]}` +
                            `${availableCitiesForSingle[getDistributedIndex(availableCitiesForSingle)]}` +
                            `${availableDistrictsForSingle[getDistributedIndex(availableDistrictsForSingle)]}`
                        );
                    default:
                        return '';
                }
            };

            // Â¶ÇÊûúÊòØÂ§öÈÄâÔºåÈöèÊú∫ÁîüÊàê1-n‰∏™ÂÄºÂπ∂Áî®Ëá™ÂÆö‰πâÂàÜÈöîÁ¨¶ËøûÊé•
            if (isMulti) {
                const options = getOptionsArray();
                // ÊúÄÂ§öÂèØÈÄâÁöÑÊï∞Èáè
                const maxOptions = options.length;
                // Ê†πÊçÆÂàÜÂ∏ÉÁ±ªÂûãÈÄâÊã©Êï∞Èáè
                let count;
                if (distribution === 'uniform') {
                    // ÂùáÂåÄÂàÜÂ∏É - 1Âà∞maxOptions‰πãÈó¥ÈöèÊú∫ÈÄâÊã©
                    count = Math.floor(Math.random() * maxOptions) + 1;
                } else {
                    // ‰ΩøÁî®ÂàÜÂ∏ÉÂáΩÊï∞ÁîüÊàêÁöÑÂÄºÊù•Á°ÆÂÆöÊï∞Èáè (1Âà∞maxOptions‰πãÈó¥)
                    count = Math.floor(generateDistributedNumber(distribution, 1, Math.max(1, maxOptions), 1, 0, 1, 10, 0.5, 2, 2, '0'));
                }
                count = Math.min(count, maxOptions); // Á°Æ‰øù‰∏çË∂ÖËøáÂèØÁî®ÈÄâÈ°πÊï∞
                
                // ÈöèÊú∫Êâì‰π±Êï∞ÁªÑÂπ∂ÂèñÂâçcount‰∏™ÂÖÉÁ¥†
                // ÊåâÁÖßÂàÜÂ∏ÉÊù•ÈÄâÊã©ÂÖÉÁ¥†ÔºåËÄå‰∏çÊòØÁÆÄÂçïÂú∞ÊéíÂ∫è
                const selected = [];
                const usedIndices = new Set();
                
                // Â∞ΩÈáèÈÄâÊã©‰∏çÂêåÁöÑÂÖÉÁ¥†
                for (let i = 0; i < count && selected.length < options.length; i++) {
                    // ‰ΩøÁî®ÂàÜÂ∏ÉÂáΩÊï∞ÈÄâÊã©Á¥¢Âºï
                    let index;
                    let attempts = 0;
                    do {
                        index = getDistributedIndex(options);
                        attempts++;
                        // Â¶ÇÊûúÂ∞ùËØï‰∫ÜÂæàÂ§öÊ¨°ËøòÊòØÊâæ‰∏çÂà∞Êú™‰ΩøÁî®ÁöÑÁ¥¢ÂºïÔºåÂ∞±ÊîæÂºÉÊü•Êâæ
                        if (attempts > 20) break;
                    } while (usedIndices.has(index));
                    
                    if (!usedIndices.has(index)) {
                        usedIndices.add(index);
                        selected.push(options[index]);
                    }
                }
                
                return selected.join(multiSeparator);
            } else {
                return generateSingleValue();
            }
        }

        function generateRandomData() {
            const rowCount = parseInt(document.getElementById('rowCount').value) || 100;
            const config = {};
            fields.forEach(field => {
                config[field] = {
                    type: document.getElementById(`type_${field}`).value,
                    min: document.getElementById(`min_${field}`).value,
                    max: document.getElementById(`max_${field}`).value,
                    decimal: document.getElementById(`decimal_${field}`).value,
                    isMulti: document.getElementById(`multi_${field}`).checked
                };
            });

            let data = [];
            for(let i = 0; i < rowCount; i++) {
                const row = {};
                fields.forEach(field => {
                    row[field] = generateRandomValue(
                        config[field].type,
                        config[field].min,
                        config[field].max,
                        field,
                        config[field].isMulti,
                        config[field].decimal
                    );
                });
                data.push(row);
            }
            return data;
        }

        function previewData() {
            const loading = document.querySelector('.loading');
            loading.classList.add('active');

            setTimeout(() => {
                const data = generateRandomData();
                const previewContainer = document.getElementById('previewContainer');
                const table = document.getElementById('previewTable');
                const thead = table.querySelector('thead');
                const tbody = table.querySelector('tbody');

                // Ê∏ÖÁ©∫Ë°®Ê†º
                thead.innerHTML = '';
                tbody.innerHTML = '';

                // Ê∑ªÂä†Ë°®Â§¥
                const headerRow = document.createElement('tr');
                fields.forEach(field => {
                    const th = document.createElement('th');
                    th.textContent = field;
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);

                // Ê∑ªÂä†Êï∞ÊçÆË°åÔºàÊúÄÂ§öÊòæÁ§∫10Ë°åÔºâ
                const previewRows = data.slice(0, 10);
                previewRows.forEach(row => {
                    const tr = document.createElement('tr');
                    fields.forEach(field => {
                        const td = document.createElement('td');
                        td.textContent = row[field];
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });

                previewContainer.style.display = 'block';
                loading.classList.remove('active');
            }, 100);
        }

        function generateData() {
            const loading = document.querySelector('.loading');
            loading.classList.add('active');

            setTimeout(() => {
                const data = generateRandomData();
                const newWorkbook = XLSX.utils.book_new();
                const worksheet = XLSX.utils.json_to_sheet(data);
                XLSX.utils.book_append_sheet(newWorkbook, worksheet, "ÁîüÊàêÊï∞ÊçÆ");

                XLSX.writeFile(newWorkbook, "generated_data.xlsx");
                loading.classList.remove('active');
            }, 100);
        }

        // Ê∑ªÂä†ÊãñÊîæÂ§ÑÁêÜ
        const dropZone = document.getElementById('dropZone');

        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('drag-over');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('drag-over');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('drag-over');
            const file = e.dataTransfer.files[0];
            if (file && (file.name.endsWith('.xlsx') || file.name.endsWith('.xls'))) {
                document.getElementById('excelFile').files = e.dataTransfer.files;
                document.getElementById('excelFile').dispatchEvent(new Event('change'));
            }
        });

        // Êï∞Â≠¶ÂàÜÂ∏ÉÂáΩÊï∞
        function generateDistributedNumber(distribution, min, max, lambda = 1, mean = 0, stddev = 1, n = 10, p = 0.5, alpha = 2, beta = 2, decimal = 'auto') {
            // Á°Æ‰øùminÂíåmax‰∏∫Êï∞Â≠ó
            min = parseFloat(min) || 0;
            max = parseFloat(max) || 100;
            
            // ËÆ°ÁÆóÂùáÂÄºÂíåÊ†áÂáÜÂ∑Æ
            // Â¶ÇÊûúÊ≤°ÊúâÊåáÂÆöÔºåÂàôÊ†πÊçÆËåÉÂõ¥ËÆ°ÁÆóÂêàÁêÜÁöÑÈªòËÆ§ÂÄº
            if (mean === 0) {
                mean = (min + max) / 2; // ÈªòËÆ§‰ΩøÁî®ËåÉÂõ¥ÁöÑ‰∏≠Èó¥ÂÄº‰Ωú‰∏∫ÂùáÂÄº
            }
            
            if (stddev === 1) {
                stddev = (max - min) / 6; // ÈªòËÆ§‰ΩøÁî®ËåÉÂõ¥ÁöÑ1/6‰Ωú‰∏∫Ê†áÂáÜÂ∑ÆÔºàÊ≠£ÊÄÅÂàÜÂ∏É68-95-99.7ËßÑÂàôÔºâ
                stddev = Math.max(1, stddev); // Á°Æ‰øùËá≥Â∞ë‰∏∫1
            }
            
            // lambdaÂèÇÊï∞‰πüÂü∫‰∫éËåÉÂõ¥
            if (lambda === 1) {
                lambda = 1 / ((max - min) / 10); // Ê†πÊçÆËåÉÂõ¥ËÆæÁΩÆlambda
                lambda = Math.max(0.1, Math.min(10, lambda)); // ÈôêÂà∂lambdaËåÉÂõ¥
            }
            
            // ËæÖÂä©ÂáΩÊï∞ÔºöÁîüÊàêÊ†áÂáÜÊ≠£ÊÄÅÂàÜÂ∏ÉÈöèÊú∫Êï∞ÔºàBox-MullerÂèòÊç¢Ôºâ
            const generateNormal = () => {
                const u1 = Math.random();
                const u2 = Math.random();
                const z0 = Math.sqrt(-2.0 * Math.log(u1)) * Math.cos(2.0 * Math.PI * u2);
                return z0;
            };
            
            // ËæÖÂä©ÂáΩÊï∞ÔºöÂ∞ÜÂÄºÈôêÂà∂Âú®minÂíåmax‰πãÈó¥
            const clamp = (value) => Math.min(Math.max(value, min), max);

            // Á°Æ‰øùminÂíåmaxÊúâÊïà
            if (!isFinite(min)) min = 0;
            if (!isFinite(max)) max = 100;
            if (min >= max) max = min + 10;

            let value;
            switch (distribution) {
                case 'uniform':
                    // ÂùáÂåÄÂàÜÂ∏É
                    value = Math.random() * (max - min) + min;
                    break;
                
                case 'normal':
                    // Ê≠£ÊÄÅÂàÜÂ∏É
                    value = mean + stddev * generateNormal();
                    break;
                
                case 'exponential':
                    // ÊåáÊï∞ÂàÜÂ∏É
                    value = min + (-Math.log(Math.random()) / lambda) * ((max - min) / 10);
                    break;
                
                case 'poisson':
                    // Ê≥äÊùæÂàÜÂ∏É (knuthÁÆóÊ≥ï)
                    lambda = Math.max(1, lambda); // lambdaÂøÖÈ°ª‰∏∫Ê≠£Êï∞
                    let L = Math.exp(-lambda);
                    let k = 0;
                    let poisson_p = 1; // ÈáçÂëΩÂêçÂèòÈáèÈÅøÂÖç‰∏éÂáΩÊï∞ÂèÇÊï∞ÂÜ≤Á™Å
                    
                    do {
                        k++;
                        poisson_p *= Math.random();
                    } while (poisson_p > L);
                    
                    // Â∞ÜÊ≥äÊùæÁªìÊûúÁº©ÊîæÂà∞ËåÉÂõ¥ÂÜÖ
                    value = min + (k - 1) * ((max - min) / (lambda * 2 + 5));
                    break;
                
                case 'binomial':
                    // ‰∫åÈ°πÂàÜÂ∏É
                    n = Math.max(10, n);
                    let successes = 0;
                    
                    for (let i = 0; i < n; i++) {
                        if (Math.random() < p) {
                            successes++;
                        }
                    }
                    
                    // Â∞Ü‰∫åÈ°πÂàÜÂ∏ÉÁªìÊûúÁº©ÊîæÂà∞ËåÉÂõ¥ÂÜÖ
                    value = min + (successes / n) * (max - min);
                    break;
                
                case 'geometric':
                    // Âá†‰ΩïÂàÜÂ∏É
                    const geo_p = Math.max(0.1, Math.min(p, 0.9)); // ÈÅøÂÖçÊûÅÁ´ØÂÄºÔºåÈáçÂëΩÂêçÈÅøÂÖçÂÜ≤Á™Å
                    const geoValue = Math.floor(Math.log(Math.random()) / Math.log(1 - geo_p));
                    value = min + (geoValue / 10) * (max - min);
                    break;
                
                case 'lognormal':
                    // ÂØπÊï∞Ê≠£ÊÄÅÂàÜÂ∏É
                    const logmean = Math.log((min + max) / 2); // ‰ΩøÁî®‰∏≠ÁÇπÁöÑÂØπÊï∞‰Ωú‰∏∫ÂùáÂÄº
                    const logstd = 0.5; // ÈÄÇ‰∏≠ÁöÑÊ†áÂáÜÂ∑Æ
                    value = Math.exp(logmean + logstd * generateNormal());
                    break;
                
                case 'pareto':
                    // Â∏ïÁ¥ØÊâòÂàÜÂ∏É
                    alpha = Math.max(1, alpha); // alphaÂøÖÈ°ªÂ§ß‰∫é0
                    value = min * Math.pow(1 - Math.random() * 0.9, -1 / alpha); // ÈÅøÂÖçÈô§‰ª•Èõ∂
                    // Áº©ÊîæÂà∞ËåÉÂõ¥ÂÜÖ
                    value = min + (value - min) * ((max - min) / Math.max(value, max));
                    break;
                
                case 'gamma':
                    // ‰ºΩÈ©¨ÂàÜÂ∏ÉÔºàËøë‰ººÔºâ
                    alpha = Math.max(1, alpha); // shape
                    let gammaValue = 0;
                    for (let i = 0; i < alpha; i++) {
                        gammaValue -= Math.log(Math.random());
                    }
                    value = min + (gammaValue / beta) * ((max - min) / 10);
                    break;
                
                case 'beta':
                    // Ë¥ùÂ°îÂàÜÂ∏ÉÔºàËøë‰ººÔºâ
                    alpha = Math.max(1, alpha);
                    beta = Math.max(1, beta);
                    const x = generateGamma(alpha, 1);
                    const y = generateGamma(beta, 1);
                    const betaValue = x / (x + y);
                    value = min + betaValue * (max - min);
                    break;
                
                default:
                    // ÈªòËÆ§ÂùáÂåÄÂàÜÂ∏É
                    value = Math.random() * (max - min) + min;
            }

            // Ê†πÊçÆÁ±ªÂûãËøîÂõûÊï¥Êï∞ÊàñÊµÆÁÇπÊï∞ÔºåÂ§ÑÁêÜÂ∞èÊï∞‰ΩçÊï∞
            // decimal: 'auto'(Ê†πÊçÆÂàÜÂ∏ÉÁ±ªÂûã), '0', '1', '2', '3', '4'
            if (decimal === '0') {
                // Êó†Â∞èÊï∞ÁÇπ
                return Math.round(clamp(value));
            } else if (decimal === '1' || decimal === '2' || decimal === '3' || decimal === '4') {
                // ÊåáÂÆöÂ∞èÊï∞‰ΩçÊï∞
                const decimalPlaces = parseInt(decimal);
                return parseFloat(clamp(value).toFixed(decimalPlaces));
            } else {
                // Ëá™Âä®Ê®°Âºè(Ê†πÊçÆÂàÜÂ∏ÉÁ±ªÂûã)
                if (distribution === 'uniform' || distribution === 'normal' || distribution === 'lognormal') {
                    // Ëøô‰∫õÂàÜÂ∏ÉÈÄöÂ∏∏ÂèØ‰ª•ËøîÂõûÂ∞èÊï∞
                    return parseFloat(clamp(value).toFixed(2));
                } else {
                    // ÂÖ∂‰ªñÂàÜÂ∏ÉÈÄöÂ∏∏ËøîÂõûÊï¥Êï∞
                    return Math.round(clamp(value));
                }
            }
        }
        
        // ‰ºΩÈ©¨ÂàÜÂ∏ÉÁöÑËæÖÂä©ÂáΩÊï∞
        function generateGamma(alpha, beta) {
            if (alpha <= 0 || beta <= 0) {
                return NaN;
            }
            
            // ÂØπ‰∫éalpha < 1Ôºå‰ΩøÁî®JohnkÁöÑÁÆóÊ≥ï
            if (alpha < 1) {
                const u = Math.random();
                return generateGamma(alpha + 1, beta) * Math.pow(u, 1 / alpha);
            }
            
            // ÂØπ‰∫éalpha >= 1Ôºå‰ΩøÁî®MarsagliaÂíåTsangÁÆóÊ≥ï
            const d = alpha - 1/3;
            const c = 1 / Math.sqrt(9 * d);
            let v, x, u;
            
            do {
                do {
                    x = generateNormal();
                    v = 1 + c * x;
                } while (v <= 0);
                
                v = v * v * v;
                u = Math.random();
            } while (u > 1 - 0.331 * x * x * x * x && 
                    Math.log(u) > 0.5 * x * x + d * (1 - v + Math.log(v)));
            
            return d * v / beta;
        }
        
        // Ê†áÂáÜÊ≠£ÊÄÅÂàÜÂ∏ÉÁîüÊàêÂô®ÔºàBox-MullerÔºâ
        function generateNormal() {
            let u = 0, v = 0;
            while (u === 0) u = Math.random();
            while (v === 0) v = Math.random();
            return Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
        }

        function addOptionInput(field, type) {
            let container;
            switch(type) {
                case 'text':
                    container = document.getElementById(`text_inputs_${field}`);
                    break;
                case 'email':
                    container = document.getElementById(`email_inputs_${field}`);
                    break;
                case 'province':
                    container = document.getElementById(`province_inputs_${field}`);
                    break;
                case 'city':
                    container = document.getElementById(`city_inputs_${field}`);
                    break;
                case 'district':
                    container = document.getElementById(`district_inputs_${field}`);
                    break;
                default:
                    return;
            }
            
            const newRow = document.createElement('div');
            newRow.className = 'option-input-row';
            
            let placeholder;
            switch(type) {
                case 'text':
                    placeholder = "ËØ∑ËæìÂÖ•ÈÄâÈ°πÂÄº";
                    break;
                case 'email':
                    placeholder = "ËØ∑ËæìÂÖ•ÈÇÆÁÆ±ÂêéÁºÄÔºåÂ¶ÇÔºögmail.com";
                    break;
                case 'province':
                    placeholder = "ËØ∑ËæìÂÖ•ÁúÅ‰ªΩ";
                    break;
                case 'city':
                    placeholder = "ËØ∑ËæìÂÖ•ÂüéÂ∏Ç";
                    break;
                case 'district':
                    placeholder = "ËØ∑ËæìÂÖ•Âå∫Âüü";
                    break;
                default:
                    placeholder = "ËØ∑ËæìÂÖ•ÈÄâÈ°π";
            }
            
            newRow.innerHTML = `
                <input type="text" class="option-input" placeholder="${placeholder}"/>
                <button type="button" class="remove-option-btn" onclick="removeOptionInput(this)">√ó</button>
            `;
            
            container.appendChild(newRow);
        }
        
        function removeOptionInput(button) {
            const row = button.parentElement;
            const container = row.parentElement;
            
            // Á°Æ‰øùËá≥Â∞ë‰øùÁïô‰∏Ä‰∏™ÈÄâÈ°π
            if (container.children.length > 1) {
                container.removeChild(row);
            } else {
                // Â¶ÇÊûúÊòØÊúÄÂêé‰∏Ä‰∏™ÔºåÂàôÊ∏ÖÁ©∫ÂÜÖÂÆπ
                const input = row.querySelector('input');
                if (input) {
                    input.value = '';
                }
            }
        }
        
        // Ëé∑ÂèñÊåáÂÆöÁ±ªÂûãÁöÑÊâÄÊúâÈÄâÈ°πÂÄº
        function getOptionValues(field, type) {
            let container;
            switch(type) {
                case 'text':
                    container = document.getElementById(`text_inputs_${field}`);
                    break;
                case 'email':
                    container = document.getElementById(`email_inputs_${field}`);
                    break;
                case 'province':
                    container = document.getElementById(`province_inputs_${field}`);
                    break;
                case 'city':
                    container = document.getElementById(`city_inputs_${field}`);
                    break;
                case 'district':
                    container = document.getElementById(`district_inputs_${field}`);
                    break;
                default:
                    return [];
            }
            
            const inputs = container.querySelectorAll('.option-input');
            return Array.from(inputs)
                .map(input => input.value.trim())
                .filter(value => value); // ËøáÊª§Á©∫ÂÄº
        }
    </script>
</body>
</html>
